# Recommendation Engine using Matrix Factorization

ì´ í”„ë¡œì íŠ¸ëŠ” **Matrix Factorization (MF)** ê¸°ë²•ì„ í™œìš©í•˜ì—¬ ì‚¬ìš©ìì˜ ì•„ì´í…œ(ì˜í™” ë“±) í‰ì ì„ ì˜ˆì¸¡í•˜ëŠ” ì¶”ì²œ ì‹œìŠ¤í…œ ì—”ì§„ì…ë‹ˆë‹¤.  **SGD(Stochastic Gradient Descent)** ì•Œê³ ë¦¬ì¦˜ì„ í†µí•´ ëŒ€ê·œëª¨ í–‰ë ¬ì„ íš¨ìœ¨ì ìœ¼ë¡œ í•™ìŠµí•˜ë©°, 1~5ì  ì‚¬ì´ì˜ í‰ì  ì˜ˆì¸¡ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

## ğŸŒŸ í•µì‹¬ íŠ¹ì§• (Key Features)

* **Matrix Factorization êµ¬í˜„**: ì‚¬ìš©ì ì ì¬ ìš”ì¸(P)ê³¼ ì•„ì´í…œ ì ì¬ ìš”ì¸(Q) í–‰ë ¬ì„ ë¶„í•´í•˜ì—¬ ëˆ„ë½ëœ í‰ì ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.
* **Bias Terms ë°˜ì˜**: ì‚¬ìš©ì í¸í–¥, ì•„ì´í…œ í¸í–¥ ë° ì „ì²´ í‰ê· ì„ ê³„ì‚°ì— í¬í•¨í•˜ì—¬ ì˜ˆì¸¡ì˜ ì •ë°€ë„ë¥¼ ë†’ì˜€ìŠµë‹ˆë‹¤.
* **SGD(í™•ë¥ ì  ê²½ì‚¬ í•˜ê°•ë²•)**: ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì— ìµœì í™”ëœ í•™ìŠµ ë°©ì‹ì„ ì±„íƒí–ˆìŠµë‹ˆë‹¤.
* **Overfitting ë°©ì§€**: L2 ì •ê·œí™”(Regularization)ë¥¼ í†µí•´ ëª¨ë¸ì˜ ì¼ë°˜í™” ì„±ëŠ¥ì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.
* **Cold Start ì²˜ë¦¬**: í•™ìŠµ ë°ì´í„°ì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ìƒˆë¡œìš´ ì‚¬ìš©ìë‚˜ ì•„ì´í…œì´ ë“±ì¥í•˜ë”ë¼ë„ í¸í–¥ê°’(Bias)ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë¦¬ì ì¸ ì˜ˆì¸¡ê°’ì„ ì œê³µí•©ë‹ˆë‹¤.

--- 

## ğŸ“Š ëª¨ë¸ ì„±ëŠ¥ (Performance)

`/dataset` ê¸°ì¤€, 50 Epoch í•™ìŠµ ì‹œ ë‹¤ìŒê³¼ ê°™ì€ **RMSE(Root Mean Square Error)** ì„±ëŠ¥ì„ í™•ì¸í•˜ì˜€ìŠµë‹ˆë‹¤. í•™ìŠµì´ ì§„í–‰ë¨ì— ë”°ë¼ ì˜¤ì°¨ê°€ ì¤„ì–´ë“¤ë©° ëª¨ë¸ì´ ì •êµí•´ì§€ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

| ì‹¤í—˜ ì°¨ìˆ˜ | RMSE ì„±ëŠ¥ | ë¹„ê³  |
| --- | --- | --- |
| 1ì°¨ ê²°ê³¼ | **0.9117** |  |
| 2ì°¨ ê²°ê³¼ | **0.9116** |  |
| 3ì°¨ ê²°ê³¼ | **0.9093** |  |
| **ìµœì¢… ê²°ê³¼** | **0.9085** | ìµœì ì˜ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì ìš© ì‹œ |

--- 

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ (Tech Stack)

* **Language**: Python 3.8 ì´ìƒ ê¶Œì¥
* **Libraries**:
* `Pandas`: ë°ì´í„° ë¡œë“œ ë° ì „ì²˜ë¦¬
* `NumPy`: ìˆ˜ì¹˜ ê³„ì‚° ë° í–‰ë ¬ ì—°ì‚°
* `OS/Sys`: ì‹œìŠ¤í…œ ì¸ì ì²˜ë¦¬ ë° íŒŒì¼ ì…ì¶œë ¥


## ğŸ“‚ ë°ì´í„° í¬ë§· (Data Format)

í•™ìŠµ ë° í…ŒìŠ¤íŠ¸ ë°ì´í„°ëŠ” ë°˜ë“œì‹œ **Tab-separated values (TSV)** í˜•ì‹ì´ì–´ì•¼ í•˜ë©°, ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤:
`user_id` | `item_id` | `rating` | `timestamp`


### ğŸ›¡ï¸ ë°ì´í„° ì •ê·œí™” ë° ì œì•½ ì¡°ê±´ (Constraints)

ëª¨ë¸ì€ ì˜ˆì¸¡ëœ í‰ì ì´ ì‹¤ì œ í‰ì  ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ ë‹¤ìŒê³¼ ê°™ì€ ì²˜ë¦¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.

* **í‰ì  ë²”ìœ„ ì œí•œ (Rating Clipping)**:
* Matrix Factorization ê³„ì‚° ê²°ê³¼ê°€ 1ì  ë¯¸ë§Œì´ê±°ë‚˜ 5ì ì„ ì´ˆê³¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ `numpy.clip` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìµœì¢… ì˜ˆì¸¡ê°’ì„ **[1.0, 5.0]** ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ê°•ì œ ì¡°ì •í•©ë‹ˆë‹¤.

```python
# ì½”ë“œ ë‚´ êµ¬í˜„ ì˜ˆì‹œ
pred = np.clip(pred, 1, 5)
```

* **ì†Œìˆ˜ì  ì •ë°€ë„**: ì˜ˆì¸¡ëœ í‰ì ì€ ê°€ë…ì„±ê³¼ ë¶„ì„ì„ ìœ„í•´ ì†Œìˆ˜ì  ë„·ì§¸ ìë¦¬ê¹Œì§€(`{pred:.4f}`) ê¸°ë¡ë©ë‹ˆë‹¤.

---


## âš™ï¸ ì‚¬ìš© ë°©ë²• (Usage)

### 1. ì„¤ì¹˜ (Installation)

ì €ì¥ì†Œë¥¼ í´ë¡ í•˜ê³  í•„ìš”í•œ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```bash
git clone https://github.com/Taeho24/Information-Retrieval-System.git

pip install pandas numpy
```


### 2. ì‹¤í–‰ (Execution)

í„°ë¯¸ë„ì—ì„œ í•™ìŠµ íŒŒì¼ê³¼ í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ ì¸ìë¡œ ë„£ì–´ ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
python recommender.py [training_file] [test_file]
```

> ì˜ˆ: `python recommender.py u1.base u1.test`

### 3. ê²°ê³¼ í™•ì¸

ì‹¤í–‰ì´ ì™„ë£Œë˜ë©´ `[training_file]_prediction.txt` íŒŒì¼ì´ ìƒì„±ë©ë‹ˆë‹¤.
ê²°ê³¼ í¬ë§·: `user_id` \t `item_id` \t `predicted_rating`


## ğŸ“ˆ í•˜ì´í¼íŒŒë¼ë¯¸í„° ì„¤ì • (Hyperparameters)

ëª¨ë¸ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œ ë‹¤ìŒ ì¸ìë“¤ì„ ì¡°ì •í•˜ì—¬ ì„±ëŠ¥ì„ ìµœì í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

* `K`: ì ì¬ ìš”ì¸ì˜ ê°œìˆ˜ (ê¸°ë³¸ê°’: 40)
* `alpha`: í•™ìŠµë¥  (Learning Rate, ê¸°ë³¸ê°’: 0.004)
* `beta`: ì •ê·œí™” ê³„ìˆ˜ (Regularization, ê¸°ë³¸ê°’: 0.02)
* `epochs`: í•™ìŠµ ë°˜ë³µ íšŸìˆ˜ (ê¸°ë³¸ê°’: 50)
